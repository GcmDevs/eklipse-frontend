<!-- Overlay -->
<div
  class="overlay"
  [class.overlay-visible]="open"
  (click)="onOverlayClick()"
  aria-hidden="true"
></div>

<!-- Sidebar Panel -->
<aside class="sidebar" [class.sidebar-open]="open" role="navigation" aria-label="Menu principal">
  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <div class="logo-icon">
        <app-nav-icon name="activity" [size]="20" />
      </div>
      <div>
        <p class="header-title">Grupo Clinica Medicos</p>
        <p class="header-subtitle">Alta Complejidad</p>
      </div>
    </div>
    <button class="close-btn" (click)="onCloseClick()" aria-label="Cerrar menu">
      <app-nav-icon name="x" [size]="20" />
    </button>
  </div>

  <!-- Navigation -->
  <nav class="nav-content">
    <p class="section-label">Modulos</p>

    @for (mod of modules; track mod.id) {
      <div class="module-item">
        <button
          class="module-btn"
          [class.module-btn-active]="isModuleOpen(mod.id)"
          (click)="toggleModule(mod.id)"
          [attr.aria-expanded]="isModuleOpen(mod.id)"
        >
          <div class="module-icon {{ accentClass(mod.accent) }}">
            <app-nav-icon [name]="mod.icon" [size]="22" />
          </div>
          <div class="module-info">
            <p class="module-label">{{ mod.label }}</p>
            <!-- <p class="module-desc">{{ mod.description }}</p> -->
          </div>
          <app-nav-icon
            name="chevron-right"
            [size]="16"
            class="module-chevron"
            [class.module-chevron-open]="isModuleOpen(mod.id)"
          />
        </button>

        <!-- Submodules -->
        <ul class="submodule-list" [class.submodule-list-open]="isModuleOpen(mod.id)">
          @for (sub of mod.submodules; track sub.id) {
            <li class="submodule-item">
              <button
                class="submodule-btn"
                [class.submodule-btn-active]="isSubmoduleOpen(mod.id, sub.id)"
                (click)="toggleSubmodule(mod.id, sub.id)"
                [attr.aria-expanded]="isSubmoduleOpen(mod.id, sub.id)"
              >
                <div class="submodule-icon {{ accentClass(sub.accent) }}">
                  <app-nav-icon [name]="sub.icon" [size]="16" />
                </div>
                <div class="submodule-info">
                  <p class="submodule-label">{{ sub.label }}</p>
                  <!-- <p class="submodule-desc">{{ sub.description }}</p> -->
                </div>
                <app-nav-icon
                  name="chevron-right"
                  [size]="14"
                  class="submodule-chevron"
                  [class.submodule-chevron-open]="isSubmoduleOpen(mod.id, sub.id)"
                />
              </button>

              <!-- Routes -->
              <ul class="route-list" [class.route-list-open]="isSubmoduleOpen(mod.id, sub.id)">
                @for (route of sub.routes; track route.id) {
                  <li class="route-item">
                    <a
                      class="route-link"
                      [routerLink]="'/' + route.href"
                      (click)="onRouteClick($event)"
                    >
                      <span class="route-dot"></span>
                      <div class="route-info">
                        <p class="route-label">{{ route.label }}</p>
                        <!-- <p class="route-desc">{{ route.description }}</p> -->
                      </div>
                      <app-nav-icon name="arrow-right" [size]="14" class="route-arrow" />
                    </a>
                  </li>
                }
              </ul>
            </li>
          }
        </ul>
      </div>
    }
  </nav>

  <!-- Footer -->
  <div class="footer">
    <div class="footer-user">
      <div class="footer-avatar">EA</div>
      <div class="footer-user-info">
        <p class="footer-user-name">Enrique de Armas</p>
        <p class="footer-user-role">Administrador</p>
      </div>
    </div>
  </div>
</aside>
